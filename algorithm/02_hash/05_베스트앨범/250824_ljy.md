[![PRO]][Link]

## 문제 해석

- 음악별 장르 배열, 음악이 재생된 횟수 배열이 주어진다.
- 가장 많이 재생된 장르순으로, 각 장르에서 가장 많이 재생된 음악 2개씩 선별하여 하나의 배열로 반환하시오.
- 각 장르별 음악이 1개인 경우도 있다. 이 때는 1개만 선택하시오.

## 1차 제출 코드

- 장르 2개 선별하는부분이 제외되어야 했다.
- 그리고 if(!mostPlaysInd)가 항상 falsy라서 제대로 동작하지 않았다.

```js
function solution(genres, plays) {
    const answer = [];
    const playsOfGenres = new Map();
    
    const topGenres = [];
    
    // 장르 (최대) 2개 선별
    
        // 장르별 플레이 수 map에 저장
        genres.forEach((el, ind)=>{
            if(playsOfGenres.has(el)) {
                playsOfGenres.set(el, playsOfGenres.get(el)+plays[ind]);
            }else{
                playsOfGenres.set(el, plays[ind]);
            }
        })
        
        // top 장르 2개 고르기
        const genresValue = [];
        for(let [key, value] of playsOfGenres){
            if(topGenres.length<2){
                topGenres.push(key)
                genresValue.push(value)
            }else{
                if(Math.max(...genresValue)<value){
                    if(genresValue[0]>genresValue[1]){
                        genresValue[1]=value
                        topGenres[1]=key
                    }else{
                        genresValue[0]=value
                        topGenres[0]=key
                    }
                }
            }
        }
    
    if(genresValue.length===1){
        answer.push(...findMostPlays(topGenres[0]));
    }else{
        let ind = 0;
        if(genresValue[1]>genresValue[0]) ind = 1; // 두번째 장르가 plays 횟수 더 많으면 인덱스 반전
        answer.push(...findMostPlays(topGenres[(0+ind)%2]));
        answer.push(...findMostPlays(topGenres[(1+ind)%2]));
    }
    
    
    function findMostPlays(genre){
        const mostPlaysInd = [];
        const mostPlaysValue = [];
        genres.forEach((el, ind)=>{
            if(el===genre){
                if(!mostPlaysInd) {
                    mostPlaysInd.push(ind);
                    mostPlaysValue.push(el);
                }
                else{
                    if(mostPlaysInd.length===1){
                        if(mostPlaysValue[0]>el){
                            mostPlaysValue.push(el);
                            mostPlaysInd.push(ind);
                        }else{
                            if(mostPlaysValue[0]<el){
                                mostPlaysValue.shift(el);
                                mostPlaysInd.shift(ind);
                                mostPlaysValue.pop();
                                mostPlaysInd.pop();
                            }else if(mostPlaysValue[1]<el){
                                mostPlaysValue[1] = el;
                                mostPlaysInd[1]=ind;
                            }
                        }
                    }
                }
            }
        })
        
        return mostPlaysInd;
    }
    
    
    return answer;
}
```

## 최종 제출 코드

```js
function solution(genres, plays) {
  // 1) 장르별 총 재생수와, 장르→곡목록(인덱스, 재생수) 맵 구성
  const totalByGenre = new Map();             // genre -> total plays
  const songsByGenre = new Map();             // genre -> [{ idx, play }...]

  for (let i = 0; i < genres.length; i++) {
    const g = genres[i];
    const p = plays[i];
    totalByGenre.set(g, (totalByGenre.get(g) || 0) + p);
    if (!songsByGenre.has(g)) songsByGenre.set(g, []);
    songsByGenre.get(g).push({ idx: i, play: p });
  }

  // 2) 장르를 총 재생수 내림차순으로 정렬
  const orderedGenres = [...totalByGenre.entries()]
    .sort((a, b) => b[1] - a[1])              // [genre, total]
    .map(([g]) => g);

  // 3) 각 장르에서 곡을 (재생수 내림차순, 인덱스 오름차순)으로 정렬 후 최대 2개 선택
  const answer = [];
  for (const g of orderedGenres) {
    const list = songsByGenre.get(g)
      .sort((a, b) => (b.play - a.play) || (a.idx - b.idx));
    if (list[0]) answer.push(list[0].idx);
    if (list[1]) answer.push(list[1].idx);
  }

  return answer;
}

```

## 시간 복잡도

- orderedGenres : O(g log g). g는 장르 수
- list : O(n log n). n은 곡 수
- **∴ O(n log n)**

## 메모

- 좀 더 많이 풀어서 연습하자. 문제를 좀 더 꼼꼼히 읽자

<!---------------------------------------------------------------------------->

[PRO]: https://github.com/GoSSaChin/algorithm-js/assets/107768516/67c43b52-bc3f-4571-a249-5519021afbb0
[Link]: https://school.programmers.co.kr/learn/courses/30/lessons/42579
